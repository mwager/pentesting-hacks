# PEN TESTING STUFF

My notes to a pen-testing class related my master exam

## cat /etc/flag-extramile1

-> cäsar chiffre 😁

how to get the flag:

cat /etc/flag-extramile1 | tr [a-zA-Z] [n-za-mN-ZA-M]

## /etc/flag-extramile2

einfach base64 encoded weil ein "=" am schluss

how to get the flag:

```
base64 -d /etc/flag-extramile2
```

## /usr/local/bin/flag-extramile3

-> einfach cat und den plain key rauskopiert!

## /usr/local/bin/flag-extramile4

-> anderer user needed zum ausführen
erster fix:

1. mit scp die binary auf kali host downloadn
2. gdb ./flag-extramile4
3. > start
4. disas

```
Dump of assembler code for function main:
0x00005555555551e6 <+0>: push rbp
0x00005555555551e7 <+1>: mov rbp,rsp
=> 0x00005555555551ea <+4>: sub rsp,0xe0
0x00005555555551f1 <+11>: mov DWORD PTR [rbp-0xd4],edi
0x00005555555551f7 <+17>: mov QWORD PTR [rbp-0xe0],rsi
0x00005555555551fe <+24>: lea rdi,[rip+0xe08] # 0x55555555600d
0x0000555555555205 <+31>: call 0x555555555050 <system@plt>
0x000055555555520a <+36>: test eax,eax
0x000055555555520c <+38>: jne 0x555555555238 <main+82>
0x000055555555520e <+40>: mov rax,QWORD PTR [rip+0x2e4b]
```

5. break \*0x000055555555520a
6. run
   -> breakt dann direkt bei \*0x000055555555520a

7. info reg eax

output 0

8. set $eax=1

WICHTIG: jne sprint wenn eax NICHT 0 is.
deshalb setzen wir eax einfach hart auf 1 HAHAHAHHAHAH

9. nun steppen bis wir den flag haben. NICE!!!

```
hydra -vv -l admin -P /usr/share/dirb/wordlists/big.txt 10.5.134.55:90 http-post-form "/pass/index.html:password=^PASS^"

hydra -l username -P /root/Desktop/Test.txt url.zz.za http-post-form "/portal/xlogin/:ed=^USER^&pw=^PASS^:S=302"
```

### Frage nun: WER is jedoch der user den wir BRÄUCHTEN?

es wird "id" an die console (system call) geschickt

## block2

info gathering:

https://censys.io/ipv4?q=141.82.0.0%2F16+and+metadata.os%3Awindows+and+tags%3Amysql
141.82.0.0/16 and metadata.os:windows and tags:mysql

### find certs:

https://crt.sh/?q=architektur-bau.hs-augsburg.de&dir=^&sort=1&group=none

### find hostnames:

https://searchdns.netcraft.com/?restriction=site+contains&host=hs-augsburg.de&position=limited

## block3

emails einer domain rausfinden:

$ theHarvester -d mwager.de -b google

-> found mail@mwager.de --> KRASS!

### DNS stuff

```
$ nslookup -type=ns hs-augsburg.de
Server: 10.0.2.3
Address: 10.0.2.3#53

Non-authoritative answer:
hs-augsburg.de nameserver = deneb.dfn.de.
hs-augsburg.de nameserver = av2.RZ.FH-Augsburg.de.
hs-augsburg.de nameserver = primestation.RZ.FH-Augsburg.de.
```

### weitere tools für DNS lookups:

```
gig AXFR domain nameserver
host -l hs-augsburg.de nameserver

host  hs-augsburg.de av2.RZ.FH-Augsburg.de
```

```
nslookup -type=mx lecture2.local 10.5.13.21
```

get SOA record (incl emails)

```
nslookup -type=soa internal-lecture.local 10.5.13.21
```

### zone transfer

```
$ dig AXFR zonetransfer.me @nsztm1.digi.ninja
```

dr.zonetransfer.me. 300 IN LOC 53 20 56.558 N 1 38 33.526 W 0.00m 1m 10000m 10m

## block4 - active info gathering -> network scanning (script 06)

Subnetzmasken, network basics etc...

### Scanning technics

```
- arping -n -i HOST # sudo
- tcpdump # wireshark light -> sudo tcpdump -n -i eth0
- ICMP -> ping
- namp
```

### namp knowledge

```
# -A Enable OS detection, version detection, script scanning, and traceroute
$ nmap -v -A scanme.nmap.org

# scan network ports: -sn: Ping Scan - disable port scan
$ nmap -v -sn scanme.nmap.org/16

# -sV -> check services running!
$ nmap -v -A -sV scanme.nmap.org

nmap scannt per default 1000 well known ports!
Scann ALL PORTS:
$ sudo nmap -A -sV -T5 10.5.123.0/24 -p- # also "-p-"

# get ip and mac of neighbour
ip neigh

nc - TCP/IP swiss army knife

$ nc 10.5.123.202 41414
ac9e06fafa7d76bade9106541dc4165dfb18155b580e2ab11924926f9583164a

```

## block5 - active info gathering #2 -> service discovery (script 07)
